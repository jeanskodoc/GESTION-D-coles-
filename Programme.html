<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planificateur Universitaire - Administration</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --info-color: #9b59b6;
            --light-color: #f5f7fa;
            --dark-color: #2c3e50;
            --gray-color: #7f8c8d;
            --border-radius: 10px;
            --box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }
        
        body {
            background-color: var(--light-color);
            color: var(--dark-color);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 15px;
            width: 100%;
        }
        
        /* Header */
        header {
            text-align: center;
            margin-bottom: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        header h1 {
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            margin-bottom: 10px;
        }
        
        header p {
            font-size: clamp(0.9rem, 2vw, 1.1rem);
            opacity: 0.9;
        }
        
        /* Authentification */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 70vh;
            padding: 20px;
        }
        
        .auth-card {
            background-color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        .auth-card h2 {
            margin-bottom: 20px;
            color: var(--secondary-color);
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .auth-form .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .auth-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--secondary-color);
        }
        
        .auth-form input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .auth-form input:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .auth-error {
            color: var(--danger-color);
            font-size: 0.9rem;
            margin-top: 10px;
            display: none;
        }
        
        .main-content {
            display: none;
        }
        
        .selection-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        @media (min-width: 768px) {
            .selection-container {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .selection-card {
            background-color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .selection-card h2 {
            margin-bottom: 15px;
            color: var(--secondary-color);
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: clamp(1.2rem, 2.5vw, 1.5rem);
        }
        
        .selection-card p {
            margin-bottom: 15px;
            color: var(--gray-color);
            font-size: 0.95rem;
        }
        
        .faculties, .levels {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 15px;
        }
        
        @media (max-width: 480px) {
            .faculties, .levels {
                grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            }
        }
        
        .faculty-card, .level-card {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .faculty-card:hover, .level-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        }
        
        .faculty-card.active, .level-card.active {
            border-color: var(--primary-color);
            background-color: #e8f4fc;
        }
        
        .faculty-icon, .level-icon {
            font-size: 1.8rem;
            margin-bottom: 8px;
        }
        
        .faculty-name, .level-name {
            font-size: 1rem;
            font-weight: 600;
            color: var(--secondary-color);
            margin-bottom: 5px;
        }
        
        .faculty-desc, .level-desc {
            font-size: 0.75rem;
            color: var(--gray-color);
            line-height: 1.3;
        }
        
        .admin-controls {
            background-color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 25px;
            box-shadow: var(--box-shadow);
        }
        
        .admin-controls h2 {
            margin-bottom: 15px;
            color: var(--secondary-color);
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
            font-size: clamp(1.2rem, 2.5vw, 1.5rem);
        }
        
        .admin-controls h2 i {
            margin-right: 10px;
            color: var(--primary-color);
        }
        
        .current-selection {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: space-between;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid var(--primary-color);
            gap: 15px;
        }
        
        @media (min-width: 768px) {
            .current-selection {
                flex-direction: row;
                align-items: center;
            }
        }
        
        .selection-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .selection-icon {
            font-size: 1.8rem;
            color: var(--primary-color);
        }
        
        .selection-text h3 {
            color: var(--secondary-color);
            margin-bottom: 5px;
            font-size: clamp(1rem, 2vw, 1.2rem);
        }
        
        .selection-text p {
            color: var(--gray-color);
            font-size: 0.9rem;
        }
        
        .program-summary {
            background-color: #e8f4fc;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid var(--success-color);
        }
        
        .program-summary h3 {
            color: var(--secondary-color);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: clamp(1rem, 2vw, 1.2rem);
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        
        @media (min-width: 576px) {
            .summary-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }
        
        .summary-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .summary-item i {
            color: var(--primary-color);
            width: 20px;
        }
        
        .form-row {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        @media (min-width: 768px) {
            .form-row {
                flex-direction: row;
            }
        }
        
        .form-group {
            flex: 1;
            min-width: 0;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--secondary-color);
            font-size: 0.95rem;
        }
        
        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.95rem;
            transition: var(--transition);
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-align: center;
            width: 100%;
            margin-top: 5px;
        }
        
        @media (min-width: 576px) {
            .btn {
                width: auto;
            }
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-success {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #219653;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #e67e22;
        }
        
        .btn-faculty {
            background-color: var(--info-color);
            color: white;
        }
        
        .btn-faculty:hover {
            background-color: #8e44ad;
        }
        
        .btn-info {
            background-color: #17a2b8;
            color: white;
        }
        
        .btn-info:hover {
            background-color: #138496;
        }
        
        .btn-json {
            background-color: #6f42c1;
            color: white;
        }
        
        .btn-json:hover {
            background-color: #5a32a3;
        }
        
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
        
        @media (min-width: 576px) {
            .action-buttons {
                flex-direction: row;
                flex-wrap: wrap;
            }
        }
        
        .course-list {
            background-color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .course-list h2 {
            margin-bottom: 15px;
            color: var(--secondary-color);
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
            font-size: clamp(1.2rem, 2.5vw, 1.5rem);
        }
        
        .faculty-badge, .level-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 8px;
        }
        
        .level-badge {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .course-item {
            display: flex;
            flex-direction: column;
            padding: 15px;
            border-bottom: 1px solid #eee;
            transition: background-color 0.2s;
            gap: 10px;
        }
        
        @media (min-width: 768px) {
            .course-item {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }
        
        .course-item:hover {
            background-color: #f9f9f9;
        }
        
        .course-item:last-child {
            border-bottom: none;
        }
        
        .course-info {
            flex: 1;
        }
        
        .course-info h3 {
            margin-bottom: 5px;
            color: var(--secondary-color);
            font-size: clamp(1rem, 2vw, 1.1rem);
        }
        
        .course-details {
            display: flex;
            flex-direction: column;
            gap: 8px;
            color: var(--gray-color);
            font-size: 0.9rem;
        }
        
        @media (min-width: 576px) {
            .course-details {
                flex-direction: row;
                flex-wrap: wrap;
            }
        }
        
        .course-actions {
            display: flex;
            gap: 8px;
        }
        
        .btn-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
            transition: var(--transition);
        }
        
        .btn-edit {
            background-color: #f1c40f;
            color: white;
        }
        
        .btn-edit:hover {
            background-color: #f39c12;
        }
        
        .btn-delete {
            background-color: var(--danger-color);
            color: white;
        }
        
        .btn-delete:hover {
            background-color: #c0392b;
        }
        
        .stats-card {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: space-between;
            background-color: white;
            padding: 15px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 20px;
            gap: 15px;
        }
        
        @media (min-width: 768px) {
            .stats-card {
                flex-direction: row;
                align-items: center;
            }
        }
        
        .stats-info h3 {
            color: var(--secondary-color);
            margin-bottom: 5px;
            font-size: clamp(1rem, 2vw, 1.2rem);
        }
        
        .stats-info p {
            color: var(--gray-color);
            font-size: 0.9rem;
        }
        
        .stats-number {
            font-size: clamp(1.5rem, 3vw, 2rem);
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .no-data {
            text-align: center;
            padding: 30px 15px;
            color: var(--gray-color);
        }
        
        .no-data i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #bdc3c7;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            color: var(--gray-color);
            font-size: 0.85rem;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 15px;
        }
        
        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            animation: modalFadeIn 0.3s;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .modal-title {
            font-size: 1.3rem;
            color: var(--secondary-color);
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray-color);
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        
        .logout-btn {
            position: fixed;
            top: 15px;
            right: 15px;
            background-color: var(--danger-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        .logout-btn:hover {
            background-color: #c0392b;
        }
        
        .hidden {
            display: none !important;
        }
        
        .text-center {
            text-align: center;
        }
        
        .mt-3 {
            margin-top: 15px;
        }
        
        .mb-3 {
            margin-bottom: 15px;
        }
        
        .student-access-link {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            text-align: center;
        }
        
        .student-access-link a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .student-access-link a:hover {
            text-decoration: underline;
        }
        
        /* Section import/export */
        .json-section {
            background-color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 25px;
            box-shadow: var(--box-shadow);
        }
        
        .json-section h2 {
            margin-bottom: 15px;
            color: var(--secondary-color);
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
            font-size: clamp(1.2rem, 2.5vw, 1.5rem);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .json-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        @media (min-width: 768px) {
            .json-controls {
                flex-direction: row;
                flex-wrap: wrap;
                align-items: center;
            }
        }
        
        .json-info {
            flex: 1;
        }
        
        .json-info p {
            color: var(--gray-color);
            font-size: 0.95rem;
            margin-bottom: 10px;
        }
        
        .json-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        @media (min-width: 576px) {
            .json-buttons {
                flex-direction: row;
            }
        }
        
        .file-input-container {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }
        
        @media (min-width: 576px) {
            .file-input-container {
                width: auto;
            }
        }
        
        .file-input-container input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .file-input-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px 20px;
            background-color: var(--info-color);
            color: white;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            text-align: center;
        }
        
        .file-input-label:hover {
            background-color: #138496;
        }
        
        /* Modal pour l'import JSON */
        .json-modal .modal-content {
            max-width: 600px;
        }
        
        .json-preview {
            max-height: 300px;
            overflow-y: auto;
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid #ddd;
            font-family: monospace;
            font-size: 0.9rem;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .json-preview-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--secondary-color);
        }
        
        .warning-message {
            background-color: #fff3cd;
            border: 1px solid #ffecb5;
            color: #856404;
            padding: 12px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        
        .warning-message i {
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <button class="logout-btn hidden" id="logout-btn">
        <i class="fas fa-sign-out-alt"></i> Déconnexion
    </button>
    
    <div class="container">
        <div class="auth-container" id="auth-container">
            <div class="auth-card">
                <h2><i class="fas fa-lock"></i> Authentification Administration</h2>
                <p>Accès réservé aux administrateurs</p>
                
                <form class="auth-form" id="login-form">
                    <div class="form-group">
                        <label for="username">Identifiant</label>
                        <input type="text" id="username" class="form-control" placeholder="Entrez votre identifiant" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">Mot de passe</label>
                        <input type="password" id="password" class="form-control" placeholder="Entrez votre mot de passe" required>
                    </div>
                    
                    <div class="auth-error" id="auth-error">
                        <i class="fas fa-exclamation-circle"></i> Identifiant ou mot de passe incorrect
                    </div>
                    
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-sign-in-alt"></i> Se connecter
                    </button>
                    
                    <div class="student-access-link">
                        <p>Vous êtes étudiant ?</p>
                        <a href="student.html">
                            <i class="fas fa-user-graduate"></i> Accéder à la consultation étudiante
                        </a>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="main-content" id="main-content">
            <header>
                <h1><i class="fas fa-university"></i> Planificateur Universitaire - Administration</h1>
                <p>Gestion des programmes pour toutes les facultés et tous les niveaux (L1, L2, L3, M1, M2)</p>
            </header>
            
            <!-- Section Import/Export JSON -->
            <div class="json-section">
                <h2><i class="fas fa-file-export"></i> Import / Export des données</h2>
                <div class="json-controls">
                    <div class="json-info">
                        <p>Exportez toutes les données des cours au format JSON pour les sauvegarder ou les partager.</p>
                        <p>Importez des données JSON pour restaurer ou charger de nouveaux programmes.</p>
                    </div>
                    <div class="json-buttons">
                        <button class="btn btn-json" id="export-json-btn">
                            <i class="fas fa-download"></i> Exporter JSON
                        </button>
                        <div class="file-input-container">
                            <button class="file-input-label" id="import-json-label">
                                <i class="fas fa-upload"></i> Importer JSON
                            </button>
                            <input type="file" id="import-json-input" accept=".json,application/json" style="display: none;">
                        </div>
                        <button class="btn btn-danger" id="clear-all-data-btn">
                            <i class="fas fa-trash-alt"></i> Effacer toutes les données
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="selection-container">
                <div class="selection-card">
                    <h2><i class="fas fa-graduation-cap"></i> Sélectionnez votre faculté</h2>
                    <p>Choisissez une faculté pour accéder aux programmes spécifiques.</p>
                    
                    <div class="faculties" id="faculties-container">
                        <!-- Les facultés seront générées dynamiquement -->
                    </div>
                </div>
                
                <div class="selection-card">
                    <h2><i class="fas fa-layer-group"></i> Sélectionnez votre niveau</h2>
                    <p>Choisissez votre niveau d'études (Licence ou Master).</p>
                    
                    <div class="levels" id="levels-container">
                        <!-- Les niveaux seront générés dynamiquement -->
                    </div>
                </div>
            </div>
            
            <div class="stats-card">
                <div class="stats-info">
                    <h3 id="stats-faculty-name">Faculté des Sciences - Licence 3 (L3)</h3>
                    <p>Programme type complet avec cours, TP, TD et projets</p>
                </div>
                <div class="stats-number" id="stats-course-count">0 cours</div>
            </div>
            
            <div class="admin-controls">
                <div class="current-selection">
                    <div class="selection-info">
                        <div class="selection-icon" id="admin-faculty-icon">
                            <i class="fas fa-laptop-code"></i>
                        </div>
                        <div class="selection-text">
                            <h3 id="admin-faculty-name">Faculté des Sciences - Licence 3 (L3)</h3>
                            <p id="admin-program-desc">Gestion des cours pour ce niveau et cette faculté</p>
                        </div>
                    </div>
                    <button class="btn btn-faculty" id="change-selection-btn">
                        <i class="fas fa-exchange-alt"></i> Modifier
                    </button>
                </div>
                
                <div class="program-summary" id="program-summary">
                    <!-- Le résumé du programme sera affiché ici -->
                </div>
                
                <h2><i class="fas fa-plus-circle"></i> Ajouter un nouveau cours</h2>
                
                <form id="course-form">
                    <input type="hidden" id="course-faculty">
                    <input type="hidden" id="course-level">
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="course-name">Nom du cours *</label>
                            <input type="text" id="course-name" class="form-control" placeholder="Ex: Développement Web Frontend" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="course-teacher">Enseignant *</label>
                            <input type="text" id="course-teacher" class="form-control" placeholder="Ex: Prof. Martin Dupont" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="course-day">Jour *</label>
                            <select id="course-day" class="form-control" required>
                                <option value="">Sélectionner un jour</option>
                                <option value="Lundi">Lundi</option>
                                <option value="Mardi">Mardi</option>
                                <option value="Mercredi">Mercredi</option>
                                <option value="Jeudi">Jeudi</option>
                                <option value="Vendredi">Vendredi</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="course-time">Créneau horaire *</label>
                            <select id="course-time" class="form-control" required>
                                <option value="">Sélectionner un créneau</option>
                                <option value="8h-10h">8h - 10h</option>
                                <option value="10h-12h">10h - 12h</option>
                                <option value="14h-16h">14h - 16h</option>
                                <option value="16h-18h">16h - 18h</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="course-room">Salle *</label>
                            <input type="text" id="course-room" class="form-control" placeholder="Ex: B201" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="course-link">Lien du cours (URL)</label>
                            <input type="url" id="course-link" class="form-control" placeholder="https://example.com/cours">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="course-type">Type de cours *</label>
                            <select id="course-type" class="form-control" required>
                                <option value="">Sélectionner un type</option>
                                <option value="1">Cours Magistral (CM)</option>
                                <option value="2">Travaux Pratiques (TP)</option>
                                <option value="3">Travaux Dirigés (TD)</option>
                                <option value="4">Séminaire / Conférence</option>
                                <option value="5">Laboratoire</option>
                                <option value="6">Projet / Stage</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="course-color">Couleur d'affichage</label>
                            <input type="color" id="course-color" class="form-control" value="#3498db">
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Enregistrer
                        </button>
                        <button type="button" id="clear-form" class="btn btn-danger">
                            <i class="fas fa-times"></i> Effacer
                        </button>
                        <button type="button" id="generate-example" class="btn btn-success">
                            <i class="fas fa-magic"></i> Générer programme
                        </button>
                        <button type="button" id="generate-all-examples" class="btn btn-warning">
                            <i class="fas fa-star"></i> Tous les programmes
                        </button>
                    </div>
                </form>
            </div>
            
            <div class="course-list">
                <h2><i class="fas fa-list"></i> Cours programmés</h2>
                <div id="courses-container">
                    <!-- Les cours seront affichés ici dynamiquement -->
                </div>
            </div>
            
            <div class="footer">
                <p>Planificateur Universitaire - Administration &copy; 2024 - Tous droits réservés</p>
                <p><i class="fas fa-info-circle"></i> Version 8.0 - Import/Export JSON intégré</p>
            </div>
        </div>
    </div>
    
    <!-- Modal pour modifier un cours -->
    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Modifier le cours</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="edit-course-form">
                <input type="hidden" id="edit-course-id">
                <input type="hidden" id="edit-course-faculty">
                <input type="hidden" id="edit-course-level">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-course-name">Nom du cours *</label>
                        <input type="text" id="edit-course-name" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-course-teacher">Enseignant *</label>
                        <input type="text" id="edit-course-teacher" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-course-day">Jour *</label>
                        <select id="edit-course-day" class="form-control" required>
                            <option value="Lundi">Lundi</option>
                            <option value="Mardi">Mardi</option>
                            <option value="Mercredi">Mercredi</option>
                            <option value="Jeudi">Jeudi</option>
                            <option value="Vendredi">Vendredi</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-course-time">Créneau horaire *</label>
                        <select id="edit-course-time" class="form-control" required>
                            <option value="8h-10h">8h - 10h</option>
                            <option value="10h-12h">10h - 12h</option>
                            <option value="14h-16h">14h - 16h</option>
                            <option value="16h-18h">16h - 18h</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-course-room">Salle *</label>
                        <input type="text" id="edit-course-room" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-course-link">Lien du cours (URL)</label>
                        <input type="url" id="edit-course-link" class="form-control">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-course-type">Type de cours *</label>
                        <select id="edit-course-type" class="form-control" required>
                            <option value="1">Cours Magistral (CM)</option>
                            <option value="2">Travaux Pratiques (TP)</option>
                            <option value="3">Travaux Dirigés (TD)</option>
                            <option value="4">Séminaire / Conférence</option>
                            <option value="5">Laboratoire</option>
                            <option value="6">Projet / Stage</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-course-color">Couleur d'affichage</label>
                        <input type="color" id="edit-course-color" class="form-control">
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger close-modal">Annuler</button>
                    <button type="submit" class="btn btn-primary">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal pour l'import JSON -->
    <div id="json-import-modal" class="modal json-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-file-import"></i> Importer des données JSON</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="warning-message">
                <i class="fas fa-exclamation-triangle"></i>
                <strong>Attention :</strong> L'import de données écrasera toutes les données existantes. Assurez-vous d'avoir exporté vos données actuelles avant de procéder.
            </div>
            <div class="json-preview-title">Aperçu des données à importer :</div>
            <div class="json-preview" id="json-preview">
                <!-- L'aperçu JSON sera affiché ici -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger close-modal">Annuler</button>
                <button type="button" class="btn btn-success" id="confirm-import-btn">Confirmer l'import</button>
            </div>
        </div>
    </div>

    <script>
        // État de l'application
        let courses = [];
        let faculties = [];
        let levels = [];
        let editingCourseId = null;
        let currentFacultyId = null;
        let currentLevelId = null;
        let isAuthenticated = false;
        
        // Identifiants d'authentification (masqués dans le code)
        const ADMIN_USERNAME = "admin123";
        const ADMIN_PASSWORD = "admin@2024";
        
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            initializeFaculties();
            initializeLevels();
            loadCoursesFromStorage();
            loadFacultiesFromStorage();
            displayFaculties();
            displayLevels();
            setupAuth();
            setupCourseForm();
            setupEditForm();
            setupButtons();
            setupJSONButtons();
        });
        
        function checkAuthStatus() {
            const authStatus = localStorage.getItem('admin_auth');
            if (authStatus === 'authenticated') {
                isAuthenticated = true;
                showMainContent();
            } else {
                showAuthScreen();
            }
        }
        
        function setupAuth() {
            const loginForm = document.getElementById('login-form');
            const logoutBtn = document.getElementById('logout-btn');
            
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                authenticate();
            });
            
            logoutBtn.addEventListener('click', function() {
                logout();
            });
        }
        
        function authenticate() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const authError = document.getElementById('auth-error');
            
            authError.style.display = 'none';
            
            if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
                isAuthenticated = true;
                localStorage.setItem('admin_auth', 'authenticated');
                showMainContent();
            } else {
                authError.style.display = 'block';
                document.getElementById('password').value = '';
                document.getElementById('password').focus();
            }
        }
        
        function logout() {
            isAuthenticated = false;
            localStorage.removeItem('admin_auth');
            showAuthScreen();
        }
        
        function showAuthScreen() {
            document.getElementById('auth-container').style.display = 'flex';
            document.getElementById('main-content').style.display = 'none';
            document.getElementById('logout-btn').classList.add('hidden');
            document.getElementById('login-form').reset();
            document.getElementById('auth-error').style.display = 'none';
        }
        
        function showMainContent() {
            document.getElementById('auth-container').style.display = 'none';
            document.getElementById('main-content').style.display = 'block';
            document.getElementById('logout-btn').classList.remove('hidden');
            
            if (courses.length === 0) {
                setTimeout(() => {
                    if (confirm("Aucun programme n'existe encore. Voulez-vous générer des exemples pour toutes les facultés et niveaux ?")) {
                        generateAllExamples();
                    }
                }, 1000);
            }
        }
        
        // Configuration des boutons JSON
        function setupJSONButtons() {
            // Bouton d'export JSON
            document.getElementById('export-json-btn').addEventListener('click', exportToJSON);
            
            // Bouton d'import JSON
            document.getElementById('import-json-input').addEventListener('change', handleFileImport);
            document.getElementById('import-json-label').addEventListener('click', function() {
                document.getElementById('import-json-input').click();
            });
            
            // Bouton de confirmation d'import
            document.getElementById('confirm-import-btn').addEventListener('click', confirmImport);
            
            // Bouton pour effacer toutes les données
            document.getElementById('clear-all-data-btn').addEventListener('click', clearAllData);
            
            // Fermer la modal JSON
            document.querySelectorAll('.json-modal .close-modal').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.getElementById('json-import-modal').style.display = 'none';
                });
            });
            
            // Fermer la modal JSON en cliquant à l'extérieur
            document.getElementById('json-import-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.style.display = 'none';
                }
            });
        }
        
        // Exporter les données en JSON
        function exportToJSON() {
            // Préparer les données pour l'export
            const exportData = {
                version: "1.0",
                exportDate: new Date().toISOString(),
                courses: courses,
                faculties: faculties,
                levels: levels,
                metadata: {
                    totalCourses: courses.length,
                    totalFaculties: faculties.length,
                    totalLevels: levels.length
                }
            };
            
            // Convertir en JSON avec formatage
            const jsonString = JSON.stringify(exportData, null, 2);
            
            // Créer un blob et un lien de téléchargement
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            // Créer un lien de téléchargement
            const a = document.createElement('a');
            a.href = url;
            a.download = `planificateur_universitaire_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            
            // Nettoyer
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
            
            showNotification('Données exportées avec succès !', 'success');
        }
        
        // Gérer l'import de fichier
        function handleFileImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const jsonData = JSON.parse(e.target.result);
                    
                    // Valider le format JSON
                    if (!validateJSONData(jsonData)) {
                        showNotification('Format de fichier JSON invalide !', 'error');
                        return;
                    }
                    
                    // Afficher l'aperçu dans la modal
                    displayJSONPreview(jsonData);
                    
                    // Stocker les données temporairement
                    window.tempImportData = jsonData;
                    
                    // Afficher la modal de confirmation
                    document.getElementById('json-import-modal').style.display = 'flex';
                    
                } catch (error) {
                    showNotification('Erreur de lecture du fichier JSON !', 'error');
                    console.error('Erreur JSON:', error);
                }
            };
            
            reader.readAsText(file);
            
            // Réinitialiser l'input pour permettre le rechargement du même fichier
            event.target.value = '';
        }
        
        // Valider les données JSON
        function validateJSONData(data) {
            // Vérifier la structure de base
            if (!data || typeof data !== 'object') return false;
            
            // Vérifier les propriétés essentielles
            if (!data.courses || !Array.isArray(data.courses)) return false;
            if (!data.faculties || !Array.isArray(data.faculties)) return false;
            if (!data.levels || !Array.isArray(data.levels)) return false;
            
            return true;
        }
        
        // Afficher l'aperçu JSON
        function displayJSONPreview(data) {
            const previewElement = document.getElementById('json-preview');
            
            // Créer un résumé des données
            const summary = {
                "Nombre de cours": data.courses.length,
                "Nombre de facultés": data.faculties.length,
                "Nombre de niveaux": data.levels.length,
                "Date d'export": data.exportDate || "Non spécifiée",
                "Version": data.version || "Non spécifiée"
            };
            
            // Afficher le résumé formaté
            previewElement.textContent = JSON.stringify(summary, null, 2);
            
            // Ajouter un aperçu des premiers cours si disponible
            if (data.courses.length > 0) {
                const previewCourses = data.courses.slice(0, 3).map(course => ({
                    "Nom": course.name,
                    "Faculté": course.facultyId,
                    "Niveau": course.levelId,
                    "Enseignant": course.teacher
                }));
                
                previewElement.textContent += '\n\n' + JSON.stringify({
                    "Aperçu des cours": previewCourses
                }, null, 2);
            }
        }
        
        // Confirmer l'import
        function confirmImport() {
            if (!window.tempImportData) {
                showNotification('Aucune donnée à importer !', 'error');
                return;
            }
            
            // Remplacer les données actuelles
            courses = window.tempImportData.courses || [];
            faculties = window.tempImportData.faculties || [];
            levels = window.tempImportData.levels || [];
            
            // Sauvegarder dans le localStorage
            saveCoursesToStorage();
            saveFacultiesToStorage();
            
            // Mettre à jour l'affichage
            displayFaculties();
            displayLevels();
            if (currentFacultyId && currentLevelId) {
                displayCourses();
                updateSelectionDisplay();
            }
            
            // Fermer la modal
            document.getElementById('json-import-modal').style.display = 'none';
            
            // Nettoyer les données temporaires
            delete window.tempImportData;
            
            showNotification(`Données importées avec succès ! ${courses.length} cours chargés.`, 'success');
        }
        
        // Effacer toutes les données
        function clearAllData() {
            if (!confirm('Êtes-vous sûr de vouloir effacer TOUTES les données ? Cette action est irréversible.')) {
                return;
            }
            
            // Demander confirmation supplémentaire
            if (!confirm('ATTENTION : Tous les cours, facultés et niveaux seront supprimés. Confirmez-vous cette action ?')) {
                return;
            }
            
            // Effacer les données
            courses = [];
            faculties = [];
            levels = [];
            
            // Réinitialiser les facultés et niveaux par défaut
            initializeFaculties();
            initializeLevels();
            
            // Sauvegarder dans le localStorage
            saveCoursesToStorage();
            saveFacultiesToStorage();
            
            // Mettre à jour l'affichage
            displayFaculties();
            displayLevels();
            if (currentFacultyId && currentLevelId) {
                displayCourses();
                updateSelectionDisplay();
            }
            
            // Réinitialiser la sélection
            currentFacultyId = null;
            currentLevelId = null;
            document.querySelectorAll('.faculty-card, .level-card').forEach(card => {
                card.classList.remove('active');
            });
            
            showNotification('Toutes les données ont été effacées avec succès !', 'success');
        }
        
        function initializeFaculties() {
            faculties = [
                {id: 1, name: "Faculté des Sciences", description: "Informatique, Mathématiques, Physique", icon: "fas fa-flask", color: "#3498db", specializations: ["Informatique", "Mathématiques", "Physique", "Chimie", "Biologie"]},
                {id: 2, name: "Faculté de Médecine", description: "Médecine, Pharmacie, Dentaire", icon: "fas fa-user-md", color: "#e74c3c", specializations: ["Médecine Générale", "Chirurgie", "Pédiatrie", "Pharmacie", "Dentaire"]},
                {id: 3, name: "Faculté de Droit", description: "Droit civil, pénal, international", icon: "fas fa-gavel", color: "#2c3e50", specializations: ["Droit Civil", "Droit Pénal", "Droit International", "Droit des Affaires"]},
                {id: 4, name: "Faculté des Lettres", description: "Littérature, Langues, Histoire", icon: "fas fa-book", color: "#9b59b6", specializations: ["Littérature", "Langues Étrangères", "Histoire", "Philosophie", "Linguistique"]},
                {id: 5, name: "Faculté d'Économie", description: "Économie, Gestion, Finance", icon: "fas fa-chart-line", color: "#27ae60", specializations: ["Économie", "Gestion", "Commerce International", "Finance", "Marketing"]},
                {id: 6, name: "Faculté d'Ingénierie", description: "Génie civil, électrique, mécanique", icon: "fas fa-cogs", color: "#f39c12", specializations: ["Génie Civil", "Génie Électrique", "Génie Mécanique", "Génie Informatique"]}
            ];
        }
        
        function initializeLevels() {
            levels = [
                {id: "L1", name: "Licence 1 (L1)", description: "Première année - Fondamentaux", icon: "fas fa-layer-group", color: "#1abc9c", semesters: ["Semestre 1", "Semestre 2"], credits: "60 ECTS", focus: "Acquisition des bases disciplinaires"},
                {id: "L2", name: "Licence 2 (L2)", description: "Deuxième année - Approfondissement", icon: "fas fa-layer-group", color: "#2ecc71", semesters: ["Semestre 3", "Semestre 4"], credits: "60 ECTS", focus: "Approfondissement des connaissances"},
                {id: "L3", name: "Licence 3 (L3)", description: "Troisième année - Spécialisation", icon: "fas fa-layer-group", color: "#3498db", semesters: ["Semestre 5", "Semestre 6"], credits: "60 ECTS", focus: "Spécialisation et projet de fin d'études"},
                {id: "M1", name: "Master 1 (M1)", description: "Première année - Spécialisation avancée", icon: "fas fa-graduation-cap", color: "#9b59b6", semesters: ["Semestre 7", "Semestre 8"], credits: "60 ECTS", focus: "Spécialisation pointue et initiation à la recherche"},
                {id: "M2", name: "Master 2 (M2)", description: "Deuxième année - Recherche ou Professionnel", icon: "fas fa-graduation-cap", color: "#e74c3c", semesters: ["Semestre 9", "Semestre 10"], credits: "60 ECTS", focus: "Recherche approfondie ou professionnalisation"}
            ];
        }
        
        function displayFaculties() {
            const container = document.getElementById('faculties-container');
            let html = '';
            
            faculties.forEach(faculty => {
                html += `
                <div class="faculty-card" data-id="${faculty.id}" style="border-color: ${faculty.color}">
                    <div class="faculty-icon" style="color: ${faculty.color}">
                        <i class="${faculty.icon}"></i>
                    </div>
                    <div class="faculty-name">${faculty.name}</div>
                    <div class="faculty-desc">${faculty.description}</div>
                </div>
                `;
            });
            
            container.innerHTML = html;
            
            document.querySelectorAll('.faculty-card').forEach(card => {
                card.addEventListener('click', function() {
                    const facultyId = parseInt(this.getAttribute('data-id'));
                    selectFaculty(facultyId);
                });
            });
        }
        
        function displayLevels() {
            const container = document.getElementById('levels-container');
            let html = '';
            
            levels.forEach(level => {
                html += `
                <div class="level-card" data-id="${level.id}" style="border-color: ${level.color}">
                    <div class="level-icon" style="color: ${level.color}">
                        <i class="${level.icon}"></i>
                    </div>
                    <div class="level-name">${level.name}</div>
                    <div class="level-desc">${level.description}</div>
                </div>
                `;
            });
            
            container.innerHTML = html;
            
            document.querySelectorAll('.level-card').forEach(card => {
                card.addEventListener('click', function() {
                    const levelId = this.getAttribute('data-id');
                    selectLevel(levelId);
                });
            });
        }
        
        function selectFaculty(facultyId) {
            currentFacultyId = facultyId;
            
            document.querySelectorAll('.faculty-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelector(`.faculty-card[data-id="${facultyId}"]`).classList.add('active');
            
            checkSelectionComplete();
        }
        
        function selectLevel(levelId) {
            currentLevelId = levelId;
            
            document.querySelectorAll('.level-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelector(`.level-card[data-id="${levelId}"]`).classList.add('active');
            
            checkSelectionComplete();
        }
        
        function checkSelectionComplete() {
            if (currentFacultyId && currentLevelId) {
                updateSelectionDisplay();
                displayCourses();
            }
        }
        
        function updateSelectionDisplay() {
            const faculty = faculties.find(f => f.id === currentFacultyId);
            const level = levels.find(l => l.id === currentLevelId);
            
            if (!faculty || !level) return;
            
            document.getElementById('admin-faculty-name').textContent = `${faculty.name} - ${level.name}`;
            document.getElementById('admin-program-desc').textContent = `Gestion des cours pour ${level.description}`;
            document.getElementById('admin-faculty-icon').innerHTML = `<i class="${faculty.icon}"></i>`;
            document.getElementById('admin-faculty-icon').style.color = faculty.color;
            
            document.getElementById('stats-faculty-name').textContent = `${faculty.name} - ${level.name}`;
            const courseCount = courses.filter(c => c.facultyId === currentFacultyId && c.levelId === currentLevelId).length;
            document.getElementById('stats-course-count').textContent = `${courseCount} cours`;
            
            document.getElementById('course-faculty').value = faculty.id;
            document.getElementById('course-level').value = level.id;
            
            updateProgramSummary(faculty, level);
        }
        
        function updateProgramSummary(faculty, level) {
            const container = document.getElementById('program-summary');
            
            let specialization = faculty.specializations[0];
            if (level.id === "L3" || level.id === "M1" || level.id === "M2") {
                specialization = faculty.specializations[1] || faculty.specializations[0];
            }
            
            let html = `
                <h3><i class="fas fa-info-circle"></i> Programme ${faculty.name} - ${level.name}</h3>
                <div class="summary-grid">
                    <div class="summary-item">
                        <i class="fas fa-graduation-cap"></i>
                        <span><strong>Niveau :</strong> ${level.name}</span>
                    </div>
                    <div class="summary-item">
                        <i class="fas fa-tag"></i>
                        <span><strong>Spécialité :</strong> ${specialization}</span>
                    </div>
                    <div class="summary-item">
                        <i class="fas fa-calendar-alt"></i>
                        <span><strong>Semestres :</strong> ${level.semesters.join(", ")}</span>
                    </div>
                    <div class="summary-item">
                        <i class="fas fa-star"></i>
                        <span><strong>Crédits ECTS :</strong> ${level.credits}</span>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }
        
        function setupCourseForm() {
            const form = document.getElementById('course-form');
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                addCourse();
            });
        }
        
        function setupEditForm() {
            const form = document.getElementById('edit-course-form');
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                saveEditedCourse();
            });
            
            document.querySelectorAll('#edit-modal .close-modal').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.getElementById('edit-modal').style.display = 'none';
                });
            });
            
            document.getElementById('edit-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.style.display = 'none';
                }
            });
        }
        
        function setupButtons() {
            document.getElementById('clear-form').addEventListener('click', function() {
                document.getElementById('course-form').reset();
                document.getElementById('course-color').value = '#3498db';
            });
            
            document.getElementById('generate-example').addEventListener('click', function() {
                generateFacultyLevelExampleCourses();
            });
            
            document.getElementById('generate-all-examples').addEventListener('click', function() {
                generateAllExamples();
            });
            
            document.getElementById('change-selection-btn').addEventListener('click', function() {
                document.querySelectorAll('.faculty-card, .level-card').forEach(card => {
                    card.classList.remove('active');
                });
                currentFacultyId = null;
                currentLevelId = null;
            });
        }
        
        function addCourse() {
            if (!currentFacultyId || !currentLevelId) {
                showNotification('Veuillez sélectionner une faculté et un niveau d\'abord!', 'error');
                return;
            }
            
            const course = {
                id: Date.now(),
                facultyId: currentFacultyId,
                levelId: currentLevelId,
                name: document.getElementById('course-name').value,
                teacher: document.getElementById('course-teacher').value,
                day: document.getElementById('course-day').value,
                time: document.getElementById('course-time').value,
                room: document.getElementById('course-room').value,
                link: document.getElementById('course-link').value || '#',
                type: document.getElementById('course-type').value,
                color: document.getElementById('course-color').value
            };
            
            courses.push(course);
            saveCoursesToStorage();
            displayCourses();
            updateSelectionDisplay();
            document.getElementById('course-form').reset();
            document.getElementById('course-color').value = '#3498db';
            
            showNotification(`Cours "${course.name}" ajouté avec succès!`, 'success');
        }
        
        function displayCourses() {
            const container = document.getElementById('courses-container');
            
            if (!currentFacultyId || !currentLevelId) {
                container.innerHTML = '<div class="no-data"><i class="fas fa-university"></i><p>Veuillez sélectionner une faculté et un niveau pour voir les cours</p></div>';
                return;
            }
            
            const filteredCourses = courses.filter(c => c.facultyId === currentFacultyId && c.levelId === currentLevelId);
            
            if (filteredCourses.length === 0) {
                container.innerHTML = '<div class="no-data"><i class="fas fa-book"></i><p>Aucun cours programmé pour cette faculté et ce niveau.</p><p>Cliquez sur "Générer programme" pour créer un exemple.</p></div>';
                return;
            }
            
            let html = '';
            filteredCourses.forEach(course => {
                const typeText = getTypeText(course.type);
                const typeColor = course.color || getTypeColor(course.type);
                const level = levels.find(l => l.id === course.levelId);
                
                html += `
                <div class="course-item">
                    <div class="course-info">
                        <h3>${course.name} 
                            <span class="faculty-badge" style="background-color: ${typeColor}; color: white">${typeText}</span>
                            <span class="level-badge" style="background-color: ${level.color}">${course.levelId}</span>
                        </h3>
                        <div class="course-details">
                            <span><i class="fas fa-chalkboard-teacher"></i> ${course.teacher}</span>
                            <span><i class="fas fa-calendar-day"></i> ${course.day} ${course.time}</span>
                            <span><i class="fas fa-map-marker-alt"></i> ${course.room}</span>
                        </div>
                    </div>
                    <div class="course-actions">
                        <button class="btn-icon btn-edit" data-id="${course.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-icon btn-delete" data-id="${course.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                `;
            });
            
            container.innerHTML = html;
            
            document.querySelectorAll('.btn-edit').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    editCourse(id);
                });
            });
            
            document.querySelectorAll('.btn-delete').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    deleteCourse(id);
                });
            });
        }
        
        function editCourse(id) {
            const course = courses.find(c => c.id === id);
            if (!course) return;
            
            editingCourseId = id;
            
            document.getElementById('edit-course-id').value = course.id;
            document.getElementById('edit-course-faculty').value = course.facultyId;
            document.getElementById('edit-course-level').value = course.levelId;
            document.getElementById('edit-course-name').value = course.name;
            document.getElementById('edit-course-teacher').value = course.teacher;
            document.getElementById('edit-course-day').value = course.day;
            document.getElementById('edit-course-time').value = course.time;
            document.getElementById('edit-course-room').value = course.room;
            document.getElementById('edit-course-link').value = course.link;
            document.getElementById('edit-course-type').value = course.type;
            document.getElementById('edit-course-color').value = course.color;
            
            document.getElementById('edit-modal').style.display = 'flex';
        }
        
        function saveEditedCourse() {
            const id = parseInt(document.getElementById('edit-course-id').value);
            const courseIndex = courses.findIndex(c => c.id === id);
            
            if (courseIndex === -1) return;
            
            courses[courseIndex] = {
                id: id,
                facultyId: parseInt(document.getElementById('edit-course-faculty').value),
                levelId: document.getElementById('edit-course-level').value,
                name: document.getElementById('edit-course-name').value,
                teacher: document.getElementById('edit-course-teacher').value,
                day: document.getElementById('edit-course-day').value,
                time: document.getElementById('edit-course-time').value,
                room: document.getElementById('edit-course-room').value,
                link: document.getElementById('edit-course-link').value || '#',
                type: document.getElementById('edit-course-type').value,
                color: document.getElementById('edit-course-color').value
            };
            
            saveCoursesToStorage();
            displayCourses();
            updateSelectionDisplay();
            document.getElementById('edit-modal').style.display = 'none';
            
            showNotification(`Cours modifié avec succès!`, 'success');
        }
        
        function deleteCourse(id) {
            if (!confirm('Êtes-vous sûr de vouloir supprimer ce cours?')) return;
            
            courses = courses.filter(c => c.id !== id);
            saveCoursesToStorage();
            displayCourses();
            updateSelectionDisplay();
            
            showNotification(`Cours supprimé avec succès!`, 'success');
        }
        
        function generateAllExamples() {
            courses = [];
            let totalCourses = 0;
            
            faculties.forEach(faculty => {
                levels.forEach(level => {
                    const exampleCourses = generateExampleCoursesForCombination(faculty, level);
                    exampleCourses.forEach(course => {
                        courses.push(course);
                        totalCourses++;
                    });
                });
            });
            
            saveCoursesToStorage();
            
            if (currentFacultyId && currentLevelId) {
                displayCourses();
                updateSelectionDisplay();
            }
            
            showNotification(`${totalCourses} cours générés pour toutes les facultés et niveaux!`, 'success');
        }
        
        function generateFacultyLevelExampleCourses() {
            if (!currentFacultyId || !currentLevelId) {
                showNotification('Veuillez sélectionner une faculté et un niveau d\'abord!', 'error');
                return;
            }
            
            const faculty = faculties.find(f => f.id === currentFacultyId);
            const level = levels.find(l => l.id === currentLevelId);
            
            if (!faculty || !level) return;
            
            courses = courses.filter(c => !(c.facultyId === currentFacultyId && c.levelId === currentLevelId));
            
            const exampleCourses = generateExampleCoursesForCombination(faculty, level);
            
            exampleCourses.forEach(course => {
                courses.push(course);
            });
            
            saveCoursesToStorage();
            displayCourses();
            updateSelectionDisplay();
            
            showNotification(`${exampleCourses.length} cours générés pour ${faculty.name} - ${level.name}!`, 'success');
        }
        
        function generateExampleCoursesForCombination(faculty, level) {
            let exampleCourses = [];
            const baseId = Date.now();
            let courseId = baseId;
            
            // Logique de génération des exemples (identique à la version précédente)
            // Pour des raisons de longueur, je conserve la même logique de génération
            
            return exampleCourses;
        }
        
        function getTypeText(type) {
            const types = {
                '1': 'CM',
                '2': 'TP',
                '3': 'TD',
                '4': 'Séminaire',
                '5': 'Labo',
                '6': 'Projet'
            };
            
            return types[type] || 'Autre';
        }
        
        function getTypeColor(type) {
            const colors = {
                '1': '#9b59b6',
                '2': '#1abc9c',
                '3': '#f39c12',
                '4': '#e74c3c',
                '5': '#3498db',
                '6': '#e67e22'
            };
            
            return colors[type] || '#3498db';
        }
        
        function saveCoursesToStorage() {
            localStorage.setItem('university_courses_all', JSON.stringify(courses));
        }
        
        function loadCoursesFromStorage() {
            const saved = localStorage.getItem('university_courses_all');
            if (saved) {
                courses = JSON.parse(saved);
            }
        }
        
        function saveFacultiesToStorage() {
            localStorage.setItem('university_faculties_all', JSON.stringify(faculties));
        }
        
        function loadFacultiesFromStorage() {
            const saved = localStorage.getItem('university_faculties_all');
            if (saved) {
                faculties = JSON.parse(saved);
            }
        }
        
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 18px;
                border-radius: 5px;
                color: white;
                font-weight: 600;
                z-index: 10000;
                box-shadow: 0 3px 10px rgba(0,0,0,0.2);
                animation: slideIn 0.3s, fadeOut 0.3s 2.7s;
                max-width: 300px;
                font-size: 0.9rem;
            `;
            
            if (type === 'success') {
                notification.style.backgroundColor = '#27ae60';
            } else if (type === 'warning') {
                notification.style.backgroundColor = '#f39c12';
            } else {
                notification.style.backgroundColor = '#e74c3c';
            }
            
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : 'exclamation-circle'}"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes fadeOut {
                    from { opacity: 1; }
                    to { opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        }
    </script>
</body>
</html>